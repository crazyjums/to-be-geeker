# 数字签名有可能被伪造吗？

> 最近在看http协议，看到https那了解到了数字签名这个东西，那么现在它既然被大面积使用，肯定是很安全的，但是我有点疑问。
> 假如存在篡改的情况。
>
> 首先存在三种情况
>
> 1. **原文被篡改**
>    这是肯定能验出来的
>    直接公钥解密数字签名取得哈希值，一对比原文的哈希，肯定不对
> 2. **数字签名被篡改**
>    这也肯定不可能，公钥解密被篡改的数字签名后得到的哈希值（因为加解密算法是公开的，应该能找到一种办法做出一种假的（至上看上去）哈希值）和原文的哈希也对不上
> 3. **两者皆被篡改**
>    公钥解密被篡改后的数字签名后得到了假的哈希值，然后用彩虹表搞出原文，这时候，原文的哈希和假哈希一样了
>
> 第三种情况有可能吗

## 数字签名的目的

1. 为了保证数据是由客户端期望的服务器发出的数据，而不是第三方劫持后发出的数据。
2. 为了保证原始服务器发出的数据没有被篡改过。

**签名就是证明A是A。**

## 数字签名的过程

其实数字签名和正常的非对称加密的过程非常相似，但又有很明显的差别，这里先说下它们的主要区别：

- 非对称加密： 客户端**公钥加密**数据，服务器用**私钥解密**数据

- 数字签名： 服务器用**私钥加密**数据，客户端用**公钥解密**数据。

**过程：**    

- 服务器端：
  - 服务器发送数据时，使用哈希函数，将这份数据计算出一个哈希值，也称作为数据的摘要，
  - 然后用服务器的私钥将这个摘要进行加密。
  - 最后，服务器会把经过加密后的摘要和数据一起发送给客户端。
- 客户端： 
  - 客户端收到数据后，首先会用公钥解密经过加密后的摘要，如果不能正常解密出摘要，则结束流程，那么说明这份数据不是由原始服务器发出的，这样解决第一个**目的1**。
  - 然后，如果能正常解析出摘要，客户端通过同样的哈希函数，将数据经过哈希得到摘要，用这个摘要和解密出的摘要进行对比，如果不一致，则说明数据被篡改过，这样解决了第二个**目的2**。

> 如果摘要和签名都被修改了，那么能否达到攻击的目的？
>
> 答：如果摘要被修改了，客户端是不能用公钥正常解密出摘要的，那么客户端就丢弃该包了

# Reference

1. [https://www.zhihu.com/question/48929386](https://www.zhihu.com/question/48929386)